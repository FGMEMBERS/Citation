<?xml version="1.0"?>

<PropertyList>

  <!-- Suppliers are defined in Citation-II-common.xml -->
  <!-- power to buses -->

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<greater-than>
	  <property>controls/electric/battery-bus-switch</property>
	  <value>0.5</value>
	</greater-than>
      </condition>
      <property>systems/electrical/outputs/bus/battery-hot</property>
    </input>
    <output>
      <property>systems/electrical/outputs/bus/battery</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<not>
	  <equals>
	    <property>controls/electric/battery-bus-switch</property>
	    <value>0</value>
	  </equals>
	</not>
	<property>controls/electric/circuit-breakers/bus-emer[1]</property>
      </condition>
      <property>systems/electrical/outputs/bus/battery-hot</property>
    </input>
    <output>
      <property>systems/electrical/outputs/bus/emer</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/electric/engine/generator</property>
	  <or>
	    <property>controls/electric/circuit-breakers/bus-left-1</property>
	    <property>controls/electric/circuit-breakers/bus-left-2</property>
	    <property>controls/electric/circuit-breakers/bus-left-3</property>
	  </or>
	  <greater-than>
	    <property>systems/electrical/outputs/suppliers/alternator</property>
	    <property>systems/electrical/outputs/bus/battery</property>
	  </greater-than>
	</and>
      </condition>
      <property>systems/electrical/outputs/suppliers/alternator</property>
    </input>
    <input>
      <condition>
	<and>
	  <greater-than>
	    <property>controls/electric/battery-bus-switch</property>
	    <value>0.5</value>
	  </greater-than>
	  <or>
	    <property>controls/electric/circuit-breakers/bus-left-1</property>
	    <property>controls/electric/circuit-breakers/bus-left-2</property>
	    <property>controls/electric/circuit-breakers/bus-left-3</property>
	  </or>
	</and>
      </condition>
      <property>systems/electrical/outputs/bus/battery</property>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>systems/electrical/outputs/bus/left</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/electric/engine[1]/generator</property>
	  <or>
	    <property>controls/electric/circuit-breakers/bus-right-1</property>
	    <property>controls/electric/circuit-breakers/bus-right-2</property>
	    <property>controls/electric/circuit-breakers/bus-right-3</property>
	  </or>
	  <greater-than>
	    <property>systems/electrical/outputs/suppliers/alternator[1]</property>
	    <property>systems/electrical/outputs/bus/battery</property>
	  </greater-than>
	</and>
      </condition>
      <property>systems/electrical/outputs/suppliers/alternator[1]</property>
    </input>
    <input>
      <condition>
	<and>
          <greater-than>
	    <property>controls/electric/battery-bus-switch</property>
	    <value>0.5</value>
	  </greater-than>
	  <or>
	    <property>controls/electric/circuit-breakers/bus-right-1</property>
	    <property>controls/electric/circuit-breakers/bus-right-2</property>
	    <property>controls/electric/circuit-breakers/bus-right-3</property>
	  </or>
	</and>
      </condition>
      <property>systems/electrical/outputs/bus/battery</property>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>systems/electrical/outputs/bus/right</property>
    </output>
  </filter>



<!--
##################
####  LIGHTS  ####
##################
  -->

  <!-- circumvent odd nasal program which controls beacon operation -->
  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/electric/circuit-breakers/bus-left/cb-light-beacon</property>
	  <property>controls/lighting/beacon-switch</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/left</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/beacon</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/landing-light-switch</property>
	  <property>controls/electric/circuit-breakers/bus-left/cb-light-landing-left</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/left</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/landing-light</property>
      <property>sim/rendering/als-secondary-lights/use-landing-light</property>
    </output>
  </filter>
  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/landing-light-switch[1]</property>
	  <property>controls/electric/circuit-breakers/bus-right/cb-light-landing-right</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/right</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/landing-light[1]</property>
      <property>sim/rendering/als-secondary-lights/use-alt-landing-light</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/strobe-switch</property>
	  <property>controls/electric/circuit-breakers/bus-left/cb-light-strobe</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/left</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/strobe</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/nav-lights-switch</property>
	  <property>controls/electric/circuit-breakers/bus-right/cb-light-nav</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/right</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/nav-lights</property>
    </output>
  </filter>

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/recog-lights-switch</property>
	  <property>controls/electric/circuit-breakers/bus-left/cb-light-recog-left</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/left</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/recog-lights-left</property>
    </output>
  </filter>
  <filter>
    <type>gain</type>
    <input>
      <condition>
	<and>
	  <property>controls/lighting/recog-lights-switch</property>
	  <property>controls/electric/circuit-breakers/bus-right/cb-light-recog-right</property>
	  <greater-than>
	    <property>systems/electrical/outputs/bus/right</property>
	    <value>20</value>
	  </greater-than>
	</and>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/lighting/recog-lights-right</property>
    </output>
  </filter>



<!--
##########################
####  Electric panel  ####
##########################
  -->

  <filter>
    <type>noise-spike</type>
    <max-rate-of-change>5</max-rate-of-change>
    <input>
      <condition>
	<equals>
	  <property>controls/electric/voltage-sel</property>
	  <value>0</value>
	</equals>
      </condition>
      <property>systems/electrical/outputs/bus/battery</property>
    </input>
    <input>
      <condition>
	<equals>
	  <property>controls/electric/voltage-sel</property>
	  <value>-1</value>
	</equals>
      </condition>
      <property>engines/engine/amp-v</property>
    </input>
    <input>
      <condition>
	<equals>
	  <property>controls/electric/voltage-sel</property>
	  <value>1</value>
	</equals>
      </condition>
      <property>engines/engine[1]/amp-v</property>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/electric/voltage-display</property>
    </output>
    <min>7</min>
    <max>45</max>
  </filter>

  <!-- simplified to enable manual engine start for the moment -->
  <filter>
    <type>gain</type>
    <input>
      <condition>
	<not>
	  <equals>
	    <property>controls/fuel/tank/boost-pump-switch</property>
	    <value>0</value>
	  </equals>
	</not>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/fuel/tank/boost-pump</property>
    </output>
  </filter>
  <filter>
    <type>gain</type>
    <input>
      <condition>
	<not>
	  <equals>
	    <property>controls/fuel/tank[1]/boost-pump-switch</property>
	    <value>0</value>
	  </equals>
	</not>
      </condition>
      <value>1</value>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/fuel/tank[1]/boost-pump</property>
    </output>
  </filter>



<!--
###########################
####  Flight Controls  ####
###########################
  -->

  <filter>
    <type>gain</type>
    <input>
      <condition>
	<property>controls/electric/circuit-breakers/bus-left/cb-speedbrakes</property>
	<greater-than>
	  <property>systems/electrical/outputs/bus/left</property>
	  <value>20</value>
	</greater-than>
      </condition>
      <property>controls/flight/speedbrake-switch</property>
    </input>
    <input>
      <value>0</value>
    </input>
    <output>
      <property>controls/flight/speedbrake</property>
    </output>
  </filter>

</PropertyList>